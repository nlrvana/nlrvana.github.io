# CVE-2024-22243&amp;CVE-2024-22259&amp;CVE-2024-22262分析

    
    
&lt;!--more--&gt;    
## 0x00 前言  
根据`Spring`官方通告  
https://spring.io/security  
其`CVE-2024-22259`是`CVE-2024-22243`的绕过  
![](https://picture-1304797147.cos.ap-nanjing.myqcloud.com/picture/202502171854231.png)
根据描述可以看到是`UriComponentBuilder`类中解析URI时错误会导致一些绕过手段  
## 0x01 漏洞分析  
### CVE-2024-22243  
根据通告构造出相应的代码  
```java  
import org.springframework.web.util.UriComponents;    
import org.springframework.web.util.UriComponentsBuilder;    
    
    
public class Poc {    
    public static void main(String[] args) throws Exception {    
        String url = &#34;http://example.com[@attacker.com&#34;;    
        UriComponents uri = UriComponentsBuilder.fromHttpUrl(url).build();    
        System.out.println(uri.getHost());    
    }    
}  
```  
看一下`commit`记录  
![](https://picture-1304797147.cos.ap-nanjing.myqcloud.com/picture/202502171614216.png)
在解析`URI`中`USER_INFO`的正则表达式中去掉了`[`，所以可以很容易的构造出payload  
`http://example.com[@attacker.com`  
![](https://picture-1304797147.cos.ap-nanjing.myqcloud.com/picture/202502171858965.png)
### CVE-2024-22259  
再来看下一个CVE的修复`commit`  
![](https://picture-1304797147.cos.ap-nanjing.myqcloud.com/picture/202502171616576.png)
可以看到删掉了`USER_INFO`中的`@`和`HOST`中的`[`，构造`payload`  
`http://@example.com[@attacker.com`  
![](https://picture-1304797147.cos.ap-nanjing.myqcloud.com/picture/202502171901042.png)
### CVE-2024-22262  
`commit`记录  
![](https://picture-1304797147.cos.ap-nanjing.myqcloud.com/picture/202502181856794.png)
其添加了`\`作为上一次修复，于是我们可以构造`payload`  
`http://attacker.com\\@example.com`  
![](https://picture-1304797147.cos.ap-nanjing.myqcloud.com/picture/202502181857702.png)
  

---

> Author: N1Rvana  
> URL: https://nlrvana.github.io/cve-2024-22243cve-2024-22259%E5%88%86%E6%9E%90/  

